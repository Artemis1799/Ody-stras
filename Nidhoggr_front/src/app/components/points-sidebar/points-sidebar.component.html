<aside class="sidebar">
  <div class="sidebar-header">
    <h3>Points</h3>
    <div class="header-buttons">
      <button 
        type="button" 
        class="export-button"
        (click)="openExportModal()"
        title="Exporter les données"
      >
        <span class="pi pi-upload"></span>
      </button>
      <button 
        type="button" 
        class="equipment-button"
        (click)="openEquipmentManager()"
        title="Gérer les équipements"
      >
        <span class="pi pi-cog"></span>
      </button>
    </div>
  </div>
  
  <div *ngIf="isLoading" class="loading">
    Chargement...
  </div>
  
  <div *ngIf="errorMessage" class="error">
    {{ errorMessage }}
  </div>
  
  <div 
    cdkDropList 
    class="points-list"
    (cdkDropListDropped)="onDrop($event)"
    *ngIf="!isLoading && !errorMessage"
  >
    <div 
      *ngFor="let point of points; let i = index" 
      class="point-item"
      [class.selected]="selectedPoint?.uuid === point.uuid"
      cdkDrag
      (click)="onPointClick(point)"
    >
      <div class="point-drag-handle" cdkDragHandle>
        <span class="drag-icon">☰</span>
      </div>
      <div class="point-content">
        <span class="point-order">{{ point.order }}</span>
        <span class="point-name">{{ getPointDisplayName(point) }}</span>
      </div>
      <div class="point-status" [class.valid]="point.isValid" [class.invalid]="!point.isValid">
        {{ point.isValid ? '✓' : '✗' }}
      </div>
    </div>
  </div>
  
  <div *ngIf="points.length === 0 && !isLoading && !errorMessage" class="empty-state">
    Aucun point disponible
  </div>
</aside>

<!-- Modal QR Code -->
<div class="modal-overlay" *ngIf="showQRModal" (click)="closeExportModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Exporter les données</h2>
      <button class="close-button" (click)="closeExportModal()">&times;</button>
    </div>
    <div class="modal-body">
      <p class="instructions">Scannez ce QR code avec votre téléphone pour envoyer les données</p>
      <div class="qr-container">
        <img [src]="qrCodeDataUrl" alt="QR Code" *ngIf="qrCodeDataUrl" />
      </div>
      <p class="url-info">{{ wsUrl }}</p>
      <p class="status-info">✅ Serveur WebSocket en attente de connexion...</p>
    </div>
  </div>
</div>
